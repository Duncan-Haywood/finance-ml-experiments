We still need to split the training preprocess from the inference preprocessing
